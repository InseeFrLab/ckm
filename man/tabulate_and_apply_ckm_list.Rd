% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tabuler_et_appliquer_ckm_sur_liste.R
\name{tabulate_and_apply_ckm_list}
\alias{tabulate_and_apply_ckm_list}
\title{Build tables and apply Cell Key Method on a list}
\usage{
tabulate_and_apply_ckm_list(
  df,
  rk_var = "rkey",
  desc_tab,
  marge_label = "Total",
  prefix = "tab",
  D,
  V,
  js = 0,
  I = NULL,
  J = NULL,
  ...
)
}
\arguments{
\item{df}{data.frame. Input microdata}

\item{rk_var}{Character. Individual key variable (NULL for no keys)}

\item{desc_tab}{data.frame. Table description with 3 columns (TAB, VAR, HRC)
describing the tables to construct}

\item{marge_label}{Character. Margin label (default: "Total")}

\item{prefix}{character. Prefix to add to table names provided in desc_tab (default: "tab")}

\item{D}{integer. Deviation parameter (must be strictly positive)}

\item{V}{numeric. Noise variance (must be strictly positive)}

\item{js}{integer. Threshold for sensitive values (default: 0). If js=0, only value 0 will be forbidden}

\item{I}{integer vector. Original values to consider}

\item{J}{integer vector. Perturbed values to consider}

\item{...}{Additional parameters passed to transition matrix creation}
}
\value{
A list containing:
  \itemize{
    \item tab: list of tables (tibbles) with CKM applied to each
    \item ptab: transition matrix used for calculations
    \item risque: tibble with risk measures for each table
    \item utilite: tibble with utility measures for each table
  }
}
\description{
This function constructs multiple tables from microdata and applies the Cell Key Method
to each table based on a description data frame specifying the table structure.
}
\details{
The desc_tab data frame must have the following structure:
\itemize{
  \item TAB: Table name or number
  \item VAR: Variable name for the table
  \item HRC: Hierarchy name if the variable has hierarchical relationship, NA otherwise
}

One row corresponds to one variable in a given table.
Variables with hierarchical relationships should be listed in decreasing order
of hierarchy (from broadest to finest level).
Two variables (e.g., REGION and DEPARTEMENT) in the same table
with a hierarchical relationship must have the same value in the HRC column.
}
\examples{
\dontrun{
data("dtest")
set.seed(123)
dtest_avec_cles <- build_individual_keys(dtest)

# Define two tables:
# tab1: DIPLOME * SEXE * AGE
# tab2: DIPLOME * TYPE * REG * DEP, where REG > DEP
desc_tableaux <- data.frame(
  TAB = c(rep(1,3), rep(2,4)),
  VAR = c("DIPLOME", "SEXE", "AGE", "DIPLOME", "TYPE", "REG", "DEP"),
  HRC = c(rep(NA, 5), rep("GEO",2))
)

res_ckm <- tabulate_and_apply_ckm_list(
  df = dtest_avec_cles,
  desc_tab = desc_tableaux,
  marge_label = "Total",
  D = 10, V = 15, js = 4
)
}

}
